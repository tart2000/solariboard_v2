<!doctype html>
<html>
<head>
  <title>Solari</title>
</head>
<body>
	<div id="container">
  </div>
  <script src="/lib/underscore.js"></script>
  <script src="/lib/Three.js"></script>
  <script src="/lib/stats.js"></script>
  <script src="/lib/events.js"></script>
  <script src="/app/SolariTexture.js"></script>
  <script src="/app/SolariRow.js"></script>
  <script src="/app/SolariFlap.js"></script>
  <script src="/app/Solari.js"></script>
  <script>
  (function () {
  var board = window.Board = new Solari;
  new SolariTexture().bind('load', function () {
    var alphaSet = this,
        row;

    document.getElementById('container').appendChild(board.el);

    // Screen size 
    var cols= 24;
    var rows = 8;
    
    // Set up the board
    _(rows).times(function () {
      row = new SolariRow(board.y);

      _(cols).times(function () {
        row.add(alphaSet);
      });
      board.add(row);
    });

    Board.start();
    
    // Test wordwrap 
    var wordwrap = function(long_string, max_char){

      var sum_length_of_words = function(word_array){
        var out = 0;
        if (word_array.length!=0){
          for (var i=0; i<word_array.length; i++){
            var word = word_array[i];
            out = out + word.length;
          }
        };
        return out;
      }

      var split_out = [[]];
      var split_string = long_string.split(' ');
      for (var i=0; i<split_string.length; i++){
        var word = split_string[i];

        if ((sum_length_of_words(split_out[split_out.length-1]) + word.length) > max_char){
          split_out = split_out.concat([[]]);
        }

        split_out[split_out.length-1] = split_out[split_out.length-1].concat(word);
      }

      for (var i=0; i<split_out.length; i++){
        split_out[i] = split_out[i].join(" ");
      }

      return split_out.join('",\n"');
    };

    var test_string = "What I am needing is to split up the string they input based on 27 characters yes always less than 27 words. View all";

    console.log(wordwrap(test_string, cols));
    
    // Set a message
    setTimeout(function () {
      Board.setMessage([
        'THUNDÃ‰RCATS THUNDERCATS ARE LOOSE THUNDERCATS ARE LOOSE',
        'ARE ON THE MOVE',
        'THUNDERCATS ARE LOOSE',
        'FEEL THE MAGIC',
        'HEAR THE ROAR',
        'THUNDERCATS ARE LOOSE',
        'THUNDER THUNDER THUNDER',
        'THUNDERCATS HO'
      ])
    }, 2000);
  }).load('https://cdn.glitch.com/0ed38d3c-4987-4983-a3f0-2347c4bf05e6%2Fchars.png?v=1579171572413', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890-.# '.split(''), 70, 63);

  })();
  </script>
  <style>
  *{
    margin:0;
    padding:0;
    overflow:hidden;
  }
  body{
    background:#111;
  }
  </style>
</body>
</html>
